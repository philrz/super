script: |
  super -o x.parquet -f parquet x.sup
  super -o y.parquet -f parquet y.sup
  super -s -c "select x from x.parquet join y.parquet on x=y"
  touch z.sup
  ! super -s -c "select x from x.parquet join z.sup on x=y"

inputs:
  - name: x.sup
    data: |
      {x:1}
  - name: y.sup
    data: |
      {y:1}
      {y:2}

outputs:
  - name: stdout
    data: |
      {x:1}
  - name: stderr
    data: |
      join on dynamic column "x" requires table-qualified reference at line 1, column 39:
      select x from x.parquet join z.sup on x=y
                                            ~
      join on dynamic column "y" requires table-qualified reference at line 1, column 41:
      select x from x.parquet join z.sup on x=y
                                              ~
      join on dynamic column "x" requires table-qualified reference at line 1, column 8:
      select x from x.parquet join z.sup on x=y
             ~
