script: |
  super compile -dag -C 'fork (values {jkey:1}) (values {kkey:1}) | join as {j,k} on k.kkey=j.jkey'
  ! super compile -dag -C 'join as {j,j} on key'
  echo // === >&2
  ! super compile -dag -C 'join on foo.key=left.key'
  echo // === >&2
  ! super compile -dag -C 'join on this'
  echo // === >&2
  ! super compile -dag -C 'cross join on left.key=1+2'


outputs:
  - name: stdout
    data: |
      null
      | fork
        (
          values {jkey:1}
        )
        (
          values {kkey:1}
        )
      | inner join as {j,k} on k.kkey==j.jkey
      | output main
  - name: stderr
    data: |
      left and right join aliases cannot be the same at line 1, column 9:
      join as {j,j} on key
              ~~~~~
      // ===
      ambiguous field reference "foo" at line 1, column 9:
      join on foo.key=left.key
              ~~~~~~~~~~~~~~~~
      // ===
      join expression cannot refer to "this" at line 1, column 9:
      join on this
              ~~~~
      // ===
      parse error at line 1, column 12:
      cross join on left.key=1+2
             === ^ ===
