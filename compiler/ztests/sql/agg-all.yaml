spq: |
  select
      key,
      and(all b),
      any(all n),
      avg(all n),
      collect(all key),
      count(all n),
      dcount(all n),
      -- fuse() is not yet supported by vector runtime.
      max(all n),
      min(all n),
      or(all b),
      sum(all n),
      union(all n)
  group by key
  order by key

vector: true

input: |
  {key:"a",n:1,b:true}
  {key:"a",n:2,b:false}
  {key:"b",n:1,b:true}
  {key:"b",n:0,b:true}
  {key:"a",n:1,b:false}

output: |
  {key:"a",and:false,any:1,avg:1.3333333333333333,collect:["a","a","a"],count:3,dcount:2::uint64,max:2,min:1,or:true,sum:4,union:|[1,2]|}
  {key:"b",and:true,any:1,avg:0.5,collect:["b","b"],count:2,dcount:2::uint64,max:1,min:0,or:true,sum:1,union:|[0,1]|}
