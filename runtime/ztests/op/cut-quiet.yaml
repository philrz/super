spq: cut foo:=quiet(foo), bar:=quiet(bar)

vector: true

input: |
  {foo:"foo0"}
  {foo:"foo1",goo:"goo1"}
  {bar:"bar2"}
  {goo:"goo3",bar:"bar3"}
  {bar:"bar4",goo:"goo4",foo:"foo4"}
  {goo:"goo5"}

output: |
  {foo:"foo0"}
  {foo:"foo1"}
  {bar:"bar2"}
  {bar:"bar3"}
  {foo:"foo4",bar:"bar4"}
  {}

---

# Rename fields.
spq: cut f:=quiet(foo), b:=quiet(bar)

vector: true

input: |
  {foo:"foo0"}
  {foo:"foo1",goo:"goo1"}
  {bar:"bar2"}
  {goo:"goo3",bar:"bar3"}
  {bar:"bar4",goo:"goo4",foo:"foo4"}
  {goo:"goo5"}

output: |
  {f:"foo0"}
  {f:"foo1"}
  {b:"bar2"}
  {b:"bar3"}
  {f:"foo4",b:"bar4"}
  {}

---

# Rename nested fields.
spq: cut ports:=id, resp_p:=quiet(id.resp_p)

vector: true

input: |
  {id:{orig_p:1::(port=uint16),resp_p:2::port}}
  {id:[3::(port=uint16),4::port]}

output: |
  {ports:{orig_p:1::(port=uint16),resp_p:2::port},resp_p:2::port}
  {ports:[3::(port=uint16),4::port]}
